<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:eb="http://java.sun.com/jsf/composite/componentes/ebos"
                xmlns:pe="http://primefaces.org/ui/extensions">
                
    <ui:param name="wgtBUI" value="wgtBUI#{frameId}" />
    <ui:param name="wgtE" value="wgtE#{frameId}" />
    <ui:insert name="params">
		<ui:remove>
	 		Se debe definir este parametro los archivos que implementen esta plantilla para sobreescribir el disenio del mismo
		</ui:remove>
		<ui:param name="optionsFinder" value="'north':{'closable':false,'resizable':false,'size':50},
				'south':{'closable':true, 'size':35},
				'west':{'minSize':180, 'maxSize':500, 'size':210, 'resizable':true},
				'east':{'minSize':80, 'maxSize':80, 'size':80},
				'center':{'minHeight':60, 'resizeWhileDragging':false, 'closable':false, 'minWidth':200, 'resizable':false}"/>
	</ui:insert>
	
	<pe:layout id="lytFinder" fullPage="false" style="min-height:450px; min-width:700px; height:100%; width:100%;" 
		options="{'panes':{'resizeWhileDragging':true,'slidable':false,'resizeWithWindow':true},#{optionsFinder}}">
		<pe:layoutPane position="north">
       		<h:form id="frmTF">
                 <p:toolbar id="tbrTF" style="overflow:hidden !important;">
		           	<p:toolbarGroup align="left">
			           	<p:commandButton id="btnSearch" value="#{msg.ebBuscar}" actionListener="#{bean._buscar}" widgetVar="wgt#{frameId}Search" 
			           		icon="ui-icon-search" update=":#{frameId}:frmR:dtR,:#{frameId}:pnlD" process="@this,:#{frameId}:frmF"/>
		               	<p:separator />
		               	<p:commandButton id="btnNew" value="#{msg.ebNuevo}" actionListener="#{bean._crear}"
		                	update=":#{frameId}:pnlE" onsuccess="#{wgtBUI}.show();#{wgtE}.show()"  
		                	rendered="#{bean.habilitaCrear}" icon="ui-icon-document"/>
		                <p:commandButton id="btnEdit" value="#{msg.ebEditar}" actionListener="#{bean._editar}" widgetVar="wgt#{frameId}Edit"
		                	update=":#{frameId}:pnlE" onsuccess="#{wgtBUI}.show();#{wgtE}.show()"  
		                	rendered="#{bean.habilitaEditar and not empty bean.dataTable}" icon="ui-icon-edit"/>
	                </p:toolbarGroup>
	                <p:separator />
					<p:toolbarGroup align="right">	                    
						<p:menuButton value="#{msg.ebOptions}">
							<p:menuitem value="#{msg.ebExportar}" rendered="#{bean.habilitaExportar}" ajax="false">
								<p:dataExporter type="pdf" target=":#{frameId}:frmR:dtR" fileName="Report"/>	
							</p:menuitem>
							<p:menuitem value="Opc 2" url="#" />
							<ui:insert name="options"/>
						</p:menuButton>
						<p:commandButton id="btnRefr" onclick="#{wgtFrame}.loadContents()" icon="ui-icon-refresh"/>
					</p:toolbarGroup>
	             </p:toolbar>
             	 <ui:remove><p:remoteCommand id="fnEditar" actionListener="#{bean._editar}" name="fnEditar"
	         		rendered="#{bean.habilitaEditar and not empty bean.dataTable}"/>
	         		</ui:remove>
       		<!-- <p:hotkey bind="ctrl+shift+f" handler="alert('Hola');" /> -->
            </h:form>
         </pe:layoutPane>
         <pe:layoutPane position="center">
            <h:form id="frmR">
	        	<p:dataTable id="dtR" 
	        		var="reg" 
	            	value="#{bean.dataTable}"
		            lazy="true" 
		            selectionMode="single"
		            selection="#{bean.activeEntity}"
		            paginator="true" 
		            paginatorTemplate="{FirstPageLink} {PreviousPageLink} {RowsPerPageDropdown} {CurrentPageReport} {NextPageLink} {LastPageLink}"  
		            rowsPerPageTemplate="5,10,15,50"
		            rows="10" 
		            emptyMessage="#{msg.ebEmptyDataTable}"
		            resizableColumns="true"
		            scrollable="true"   
		            rowKey="#{reg.id}">
		            
					<p:ajax event="rowDblselect" disabled="#{not(bean.habilitaEditar and not empty bean.dataTable)}" 
						onsuccess="wgt#{frameId}Edit.jq.click()"/>
					<p:ajax event="rowSelect" update=":#{frameId}:pnlD" global="false"/>  
	  
		            <p:column headerText="#{msg.ebId}" width="30" style="text-align:center" resizable="false" >
		                 <eb:outputText value="#{reg.id}" />
		            </p:column>
		             
		            <ui:insert name="results" />
		     	</p:dataTable>
		     	<p:blockUI block="dtR" trigger=":#{frameId}:frmTF:btnSearch" />
		    </h:form> 	
       	 </pe:layoutPane>
         <pe:layoutPane position="west">
         	<h:form id="frmF">
        		<ui:insert name="filters"/>
        	</h:form>
         </pe:layoutPane>
         <pe:layoutPane position="east" rendered="false">
	        
         </pe:layoutPane>
         <pe:layoutPane position="south">
         	<h:panelGrid id="pnlD" columns="6" cellpadding="4">
         		<p:outputLabel for="id" value="#{msg.ebId}" rendered="#{bean.activeEntity.id ne null}"/>
	    		<eb:outputText id="id" value="#{bean.activeEntity.id}" rendered="#{bean.activeEntity.id ne null}"/>
	    		<p:outputLabel for="creado" value="#{msg.ebCreado}" rendered="#{bean.activeEntity.creado ne null}"/>
		        <eb:outputDate id="creado" value="#{bean.activeEntity.creado}" title="#{msg.ebPor}: #{bean.activeEntity.creador.username}" rendered="#{bean.activeEntity.creado ne null}"/>
		        <p:outputLabel for="modificado" value="#{msg.ebModificado}" rendered="#{bean.activeEntity.modificado ne null}"/>
		        <eb:outputDate id="modificado" value="#{bean.activeEntity.modificado}" title="#{msg.ebPor}: #{bean.activeEntity.modificador.username}" rendered="#{bean.activeEntity.modificado ne null}"/>
	    		<ui:insert name="details"/>
	        </h:panelGrid>
         </pe:layoutPane>
    </pe:layout>
    
    <p:blockUI widgetVar="#{wgtBUI}" block=":#{frameId}:lytFinder" />
    
	<p:dialog id="dlgE" widgetVar="#{wgtE}" header="#{msg.ebEdit}" height="350" width="600" appendToBody="true" 
		showEffect="fade" hideEffect="fade" draggable="true" onHide="#{wgtBUI}.hide(); wgt#{frameId}Search.jq.click()">
   		<p:outputPanel id="pnlE">
   			<p:outputPanel rendered="#{bean.activeEntity ne null}">
				<ui:insert name="master"/>
			</p:outputPanel>
		</p:outputPanel>    		
    </p:dialog>
    
    <p:draggable for="dlgE" 
	        opacity="0.5" 
	        dragOnly="true"
	        handle=".ui-dialog-titlebar" 
	        containment="#center"/>
	        <!-- handle=".ui-dialog-titlebar" -->
	
</ui:composition>
