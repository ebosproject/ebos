<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:pl="http://platform.com.ec/ui">

	<pl:layout id="layHome" widgetVar="fullLayoutWidget"
		options="#{layoutMB.layoutOptionsHome}">

		<ui:include id="pnlTimeout" src="pnlTimeout.xhtml" />
		<ui:include id="pnlChangePwd" src="pnlChangePswd.xhtml" />

		<pl:layoutPane id="lyNorth" position="north">
			<h:form id="frmCerrarSesion" prependId="false">
				<p:menubar id="menubar">
					<p:menuitem
						value="#{msg.plSalir} (#{sesionUsuario.usuario.username})"
						actionListener="#{sesionUsuario.cerrarSesion}" ajax="false"
						update="@all" />
					<p:submenu label="#{msg.plCuenta}">
						<p:menuitem value="#{msg.plCambiarPassword}"
							onclick="dlgCambiarPwd.show()"/>
					</p:submenu>					
				</p:menubar>
			</h:form>
			<p:growl id="msgHome" autoUpdate="true" sticky="true" />
		</pl:layoutPane>

		<pl:layoutPane id="lyWest" position="west">
			<h:form id="frmMenu">
				<p:panelMenu id="pnlMenu" model="#{modelMB.menuModel}" />
				<script>
                    jQuery('#frmMenu a').mouseup(function(event){jsPreventDefault(event, this)});
                </script>
			</h:form>
		</pl:layoutPane>

		<pl:layoutPane id="lyCenter" position="center">
			<h:form id="commands">
				<p:remoteCommand name="abrirOpcion"
					actionListener="#{modelMB.abrirOpcion}" update=":tabOptions" />
			</h:form>
			<p:tabView id="tabOptions" binding="#{modelMB.tabModel}"
				widgetVar="tabView" dynamic="true">
				<p:ajax event="tabChange" listener="#{modelMB.cambiarOpcion}" />
				<p:ajax event="tabClose" listener="#{modelMB.cerrarOpcion}" />
			</p:tabView>			
			<div id="tabContent"
				class="ui-panel ui-widget ui-widget-content ui-corner-all"
				style="height: 100%">
				<ui:repeat var="tab" value="#{modelMB.tabModel.children}">
					<div id="pnl_#{tab.id}" style="display: block; height:100%">
					<iframe id="iframe_#{tab.opcion.id}" src="#{tab.opcion.target}" frameborder="0" class="border0" width="100%" height="100%">                        
				        <p>Su navegador no soporta iframes</p></iframe>
			        </div>
				</ui:repeat>				
			</div>					
			<script>
            	jQuery('#tabOptions li a').mouseup(function(event){jsPreventDefault(event, this)});
        	</script>
		</pl:layoutPane>

		<pl:layoutPane id="lySouth" position="south">
			<ui:include id="south" src="south.xhtml" />
		</pl:layoutPane>
	</pl:layout>

</ui:composition>
